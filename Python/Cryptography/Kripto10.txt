'''
 7 užduotis 
1. Viešasis kuprinės raktas yra  [v_1,...,v_8,p]=  [14671687, 26863017, 29031658, 36334311, 9689884, 1484900, 25185267, 40910202, 46228231].
Pirmoji privataus rakto komponentė  w_1=293192.
Iššifruokite šifrą 
[46000755, 4348415, 26442691, 40708466, 44541595, 14038299, 46026495, 31018582, 4348415, 29031658, 26442691, 14038299, 5833315, 1257424, 4348415]

2. Viešasis Grahamo-Shamiro kuprinės kriptosistemos raktas   [v_1,...,v_8,p]=  [90601360904, 48454384606, 26240043676, 67095509768, 68861694218, 17305612549, 96462088213, 24025360652, 97920745199].
Pirmoji privataus rakto komponentė w_1=16925720700.
Pranešimas slypi  11-18 bituose (skaičiuojant nuo galo). 
Iššifruokite G-SH kuprinės šifrą 
[66435896517, 61174805400, 69660737953, 43869192851, 42410535865, 85200166052, 66435896517, 26240043676, 59716148414, 18104656284, 44176720315, 799043735, 66435896517]

'''
#1)
V=[14671687, 26863017, 29031658, 36334311, 9689884, 1484900, 25185267, 40910202]
w_1=293192
p=46228231
C=[46000755, 4348415, 26442691, 40708466, 44541595, 14038299, 46026495, 31018582, 4348415, 29031658, 26442691, 14038299, 5833315, 1257424, 4348415]
V_1=V[0] # T*V_1=W_1 mod P
#gcd(V_1, p) # if 1 ok
t = w_1/V_1%p
w = [t*v%p for v in V] # w = [293192, 341815, 727898, 1455039, 2874293, 5768729, 11517874, 23003121]
Cn = [t*v%p for v in C] # Cn = [2524752, 24072834, 19811355, 44233730]

def kupr(W, w):
    V=W[::-1]
    s=''
    x=w
    for w in V:
        if w <= x:
            s+='1'
            x=x-w
        else:
            s+='0'
    return s[::-1]
char=''
for i in Cn:
    #char+=kupr([293192, 341815, 727898, 1455039, 2874293, 5768729, 11517874, 23003121], i)
    char+=chr(int(kupr(w, i), 2))
    
char # 'pavojinga vieta'

u='''
#2)
w_1=16925720700
v_1=90601360904
p=97920745199
C=[66435896517, 61174805400, 69660737953, 43869192851, 42410535865, 85200166052, 66435896517, 26240043676, 59716148414, 18104656284, 44176720315, 799043735, 66435896517]
#gcd(v_1, p) # if 1 ok
t = w_1/v_1%p
Cn=[c*t%p for c in C] # Cn = [16593714686, 88540947652, 50336124333, 23631978972]
char=''
i=0
for _ in Cn:    
    char+=chr(int(bin(Cn[i])[-18:-10], 2))
    i+=1
print(char)
'''