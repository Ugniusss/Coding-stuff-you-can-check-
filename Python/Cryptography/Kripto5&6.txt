
 30 užduotis 
1. Feistelio šifro su trimis iteracijomis raktas =[132, 235, 165]
Iteracijos funkcija (m|k)^((k//16)&m)
Iššifruokite šifrą 
[[42, 164], [56, 167], [43, 170], [42, 188], [45, 164], [37, 178], [48, 175], [37, 162], [36, 170], [36, 180], [43, 166], [32, 167], [38, 184], [41, 172], [43, 168], [35, 174], [54, 171], [33, 162], [32, 176], [40, 175], [46, 168], [45, 170], [63, 165], [59, 162], [52, 190], [44, 169], [38, 188], [40, 167], [51, 170], [59, 162], [35, 176], [56, 161], [37, 162], [33, 191], [50, 175], [47, 168], [49, 177], [42, 191], [59, 178], [58, 164], [45, 168], [55, 170], [40, 167], [42, 184], [49, 174], [38, 173], [33, 166], [51, 170], [59, 162], [35, 184], [36, 180], [46, 164], [32, 186], [51, 187], [51, 170], [52, 190], [59, 162], [34, 184], [36, 162], [61, 166]]

2. Feistelio šifro su dviem iteracijomis raktas =['?', 201]
Iteracijos funkcija (m|k)^((m//16)&k)
Iššifruokite šifrą 
[[164, 164], [168, 167], [184, 187], [166, 170], [161, 187], [173, 162], [166, 189], [173, 174], [171, 164], [186, 190], [172, 174], [191, 191], [167, 170], [173, 170], [161, 181], [160, 168], [160, 167], [175, 170], [162, 183], [183, 167], [161, 179], [169, 162], [185, 190], [164, 185], [170, 162], [177, 176], [162, 173], [171, 174], [191, 190], [177, 160], [166, 179], [166, 170], [183, 161], [166, 170], [177, 161], [166, 179], [166, 170], [180, 176], [166, 170], [187, 189]]

3. Feistelio šifro su dviem iteracijomis raktas nežinomas
Iteracijos funkcija (m&k)^((k%16)|m)
Iššifruokite šifrą 
[[83, 19], [84, 8], [82, 22], [66, 1], [66, 30], [87, 25], [67, 13], [85, 31], [73, 3], [87, 25], [75, 29], [64, 6], [73, 18], [78, 5], [70, 28], [64, 6], [70, 28], [87, 17], [76, 23], [72, 12], [70, 0], [87, 8], [70, 29], [84, 13], [66, 4], [67, 30], [72, 3], [78, 18], [76, 10], [83, 19], [84, 15], [72, 12], [78, 14], [84, 8], [74, 16], [75, 15], [78, 14], [84, 16], [70, 0], [87, 28], [82, 17], [76, 6], [75, 1], [84, 18], [84, 8], [78, 18], [76, 15], [70, 0], [67, 9], [87, 23], [81, 23], [84, 26], [87, 25], [84, 26], [82, 17], [78, 8], [85, 17], [70, 4], [87, 25], [83, 25], [76, 12], [78, 0], [76, 10], [83, 25], [73, 15], [85, 10], [70, 5], [78, 10], [104, 71]] , jei tekstas prasideda TO

1) Feistelio schema
'''
1. Feistelio šifro su trimis iteracijomis raktas =[132, 235, 165]
Iteracijos funkcija (m|k)^((k//16)&m)
Iššifruokite šifrą 
[[42, 164], [56, 167], [43, 170], [42, 188], [45, 164], [37, 178], [48, 175], [37, 162], [36, 170], [36, 180], [43, 166], [32, 167], [38, 184], [41, 172], [43, 168], [35, 174], [54, 171], [33, 162], [32, 176], [40, 175], [46, 168], [45, 170], [63, 165], [59, 162], [52, 190], [44, 169], [38, 188], [40, 167], [51, 170], [59, 162], [35, 176], [56, 161], [37, 162], [33, 191], [50, 175], [47, 168], [49, 177], [42, 191], [59, 178], [58, 164], [45, 168], [55, 170], [40, 167], [42, 184], [49, 174], [38, 173], [33, 166], [51, 170], [59, 162], [35, 184], [36, 180], [46, 164], [32, 186], [51, 187], [51, 170], [52, 190], [59, 162], [34, 184], [36, 162], [61, 166]]
'''

C=[[42, 164], [56, 167], [43, 170]]
key=[132, 235, 165]

def iter(M,k,f):
    r=M[1]
    l=M[0]^^eval(f)
    return [r,l]

f='(r|k)^((k//16)&r)'
c=C[0]


m=iter(c,key[2],f)
m=iter(m,key[1],f)
m=iter(m,key[0],f)

m=[m[1],m[0]]
chr(m[0])+chr(m[1])

2)
2. Feistelio šifro su trimis iteracijomis raktas =[186, 116, 116]
Iteracijos funkcija (m|k)^((m//16)&k) inicializacijos vektorius [31, 110]
Iššifruokite šifrą  sudarytą CBC režimu
[[23, 212], [145, 123], [14, 71], [31, 248], [153, 86], [23, 110], [20, 218], [129, 98], [10, 86], [9, 225], [148, 89], [18, 110], [23, 215], [146, 105], [29, 71], [23, 248], [158, 88], [25, 125], [18, 201], [156, 118], [27, 69], [0, 245], [152, 76], [24, 113], [21, 205], [158, 108], [25, 80], [20, 246], [150, 75], [29, 97], [16, 196], [129, 118], [11, 71], [6, 243], [153, 77], [19, 116], [26, 206], [156, 97], [29, 93], [16, 236], [137, 92], [17, 103], [19, 208], [146, 114], [31, 64], [21, 245], [143, 72], [9, 120], [21, 193], [144, 115], [2, 72], [24, 229], [145, 89], [27, 112], [29, 203], [158, 117], [15, 75], [1, 240], [142, 64], [3, 99], [1, 192], [158, 116], [17, 79], [6, 253], [131, 72], [15, 118], [19, 199], [142, 117], [4, 83], [30, 227], [144, 65], [29, 127], [20, 202], [135, 114], [6, 92], [5, 225], [213, 54]]

3)

IV=[31, 110]
C=[[23, 212], [145, 123], [14, 71]]
key=[186, 116, 116]

def iter(M,k,f):
    r=M[1]
    l=M[0]^^eval(f)
    return [r,l]

f='(r|k)^((r//16)&k)'
c=C[0]

m=iter(c,key[2],f)
m=iter(m,key[1],f)
m=iter(m,key[0],f)

m=[m[1]^^IV[0],m[0]^^IV[1]]
chr(m[0])+chr(m[1])

c=C[1]


m=iter(c,key[2],f)
m=iter(m,key[1],f)
m=iter(m,key[0],f)

m=[m[1]^^C[0][0],m[0]^^C[0][1]]
chr(m[0])+chr(m[1])

r=0
k=key[0]
bl=eval(f)
[bl, bl]




2) GALOPJIEISINOREJONULEKTIIDANGUKADGALETUPASIJUOKTIISANGELUIRPATIESVIESPATIESDIEVO
3) TOSSUKELESPADARENEPALYGINTIDAUGIAUPIKTOKAIPPATSVEIDRODISKITOSTOKIOSSMULKIOSKAIPDULKELESISSISKLAIDEPOVISAPASAULIIRKAMPATEKOIAKITENIRPALIKO 

6.2) EINUPERLAUKAANTKELIOTABOKINEATIDARAUJOJEKITATIKDIDESNEATIDARAUTADIDESNEJOJEVELKITATIKDARDIDESNEATIDARAUTADARDIDESNEJOJESKRYNIAPILNAGRAZIAUSIOSILKORIETIMU 
6.3) 
DROZIAUPERJIOGIGRAZIAUSIAPILISBESTOVINTIPASIBALNOJAUVORAIRLAPATAILAPATAIPROVARTUSJTAPILI

6.4)
'''
4. Feistelio šifro su trimis iteracijomis raktas =[186, 116, 116]
Iteracijos funkcija (m|k)^((m//16)&k)
Ši funkcija naudojama kaip skaitliuko funkcija su parametrais r= bloko numeris, k=k[0]
 Iššifruokite šifrą  sudarytą CRT režimu
[[189, 133], [183, 138], [170, 142], [178, 128], [179, 147], [178, 143], [181, 146], [190, 139], [181, 138], [174, 137], [191, 143], [175, 140], [179, 132], [186, 143], [189, 149], [176, 128], [190, 131], [186, 137], [191, 144], [174, 149], [187, 147], [178, 139], [175, 143], [176, 149], [179, 141], [168, 132], [180, 131], [190, 137], [175, 137], [169, 145], [187, 148], [178, 132], [171, 146], [176, 128], [171, 148], [184, 145], [177, 133], [170, 133], [177, 133], [175, 142]]

'''
key=[186, 116, 116]
C=[[189, 133], [183, 138], [170, 142], [178, 128], [179, 147], [178, 143], [181, 146], [190, 139], [181, 138], [174, 137], [191, 143], [175, 140], [179, 132], [186, 143], [189, 149], [176, 128], [190, 131], [186, 137], [191, 144], [174, 149], [187, 147], [178, 139], [175, 143], [176, 149], [179, 141], [168, 132], [180, 131], [190, 137], [175, 137], [169, 145], [187, 148], [178, 132], [171, 146], [176, 128], [171, 148], [184, 145], [177, 133], [170, 133], [177, 133], [175, 142]]
f='(r|k)^((r//16)&k)'
#T=[t0,t1,t2]

def iter(M,k,f):
    r=M[1]
    l=M[0]^^eval(f)
    return [r,l]
m=''
i=0
for c in C:
    c=C[i]
    r=i
    k=key[0]
    bl=eval(f)
    t0=[bl, bl]
    t=iter(t0, key[0], f)
    t=iter(t, key[1], f)
    t=iter(t, key[2], f)
    t=[t[1],t[0]]
    m+=chr(c[0]^^t[0])+chr(c[1]^^t[1])
    i=i+1
m