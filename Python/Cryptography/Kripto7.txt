'''
1. Tekstas, prasideda raidėmis GI
Jis užšifruotas naudojant 8 registrų generuotą rakto srautą. Iššifruokite šifrą 
[233, 148, 17, 238, 242, 59, 51, 190, 162, 159, 146, 233, 226, 1, 33, 229, 156, 20, 247, 242, 48, 34, 175, 163, 144, 139, 249, 246, 3, 59, 253, 148, 16, 251, 232, 33, 47, 190, 164, 159, 146, 255, 254, 28, 62, 239, 144, 28, 224, 242, 60, 36, 186, 168, 135, 141, 234, 229, 16, 47, 231, 142, 9, 255, 245, 50, 51, 185, 168, 158, 143, 226, 252, 22, 62, 225, 143, 20, 244, 250, 62, 51, 163, 190, 129, 154, 248, 254, 4, 62, 225, 150, 14, 238, 242, 59, 63, 164, 166, 148, 136, 255, 246, 30, 41, 231, 150, 28, 247, 250, 38, 51, 185, 184, 133, 154, 248, 246, 2, 34, 247, 151, 24, 255, 246, 48, 37, 188, 172, 135, 136, 255, 238, 3, 39, 228, 148, 19, 251, 242, 52, 36, 171, 185, 144, 146, 239, 246, 26, 47, 239, 142, 25, 251, 233, 52, 35, 173, 168, 135, 154, 234, 229, 21, 34, 225, 154, 28, 243, 233, 63, 63, 164, 164, 144, 144, 234, 254, 7, 32, 235, 154, 28, 246, 254, 63, 57, 185, 184, 133, 137, 234, 228, 3, 39, 250, 156, 30, 243, 250, 32, 37, 190, 172, 156, 156, 234, 253, 22, 39, 254, 156, 14, 243, 237, 52, 63, 174, 168, 155, 148, 224, 246, 19, 45, 231, 156, 13, 251, 239, 38, 63, 165, 167, 144, 144, 234, 250, 22, 60, 225, 151, 24, 233, 238, 38, 61, 171, 160, 151, 148, 234, 254, 26, 47, 224, 146, 14, 243, 233, 35, 51, 184, 166, 134, 150, 234, 254, 28, 47, 234, 144, 18, 238, 242, 59, 57, 185, 166, 148, 151, 255, 254, 25, 47, 228, 156, 22, 251, 246, 63, 63, 186, 172, 134, 146, 236, 251, 18, 35, 244, 152, 23, 239, 237, 52, 63, 161, 184, 134, 148, 253, 238, 5, 47, 231, 141, 17, 239, 232, 33, 55, 160, 172, 158, 154, 230, 253, 30, 62, 239, 142, 20, 253, 233, 58, 52, 175, 167, 128, 145, 254, 228, 2, 32, 251, 142, 22, 251, 255, 55, 51, 160, 168, 146, 146, 234, 254, 30, 60, 254, 156, 17, 243, 254, 50, 51, 166, 164, 148, 146, 251, 229, 24, 37, 251, 143, 20, 239, 244, 38, 60, 163, 189, 135, 154, 238, 253, 24, 58, 231, 152, 14, 243, 250, 60, 60, 171, 191, 148, 149, 224, 246, 4, 33, 228, 148, 19, 255, 225, 60, 56, 165, 166, 148, 154, 255, 228, 22, 37, 247, 137, 20]
'''

def	xor(a,b):
    m=min(len(a),len(b))
    return [(a[i]+b[i])%2 for i in range(0,m)] 	

def trf(M,i,lin):
    for j in lin:
	    M[j]=xor(M[i],M[j])
    #for j in range(len(M)):
    #    print (M[j])
    return M  
  
def shift(c,x): # c - coefficients, x - initial state, len(c)=len(x)
    bt=0
    n=len(x)
    xf=[0]*n
    for j in range(0,n):
        bt+=c[j]*x[j]
    for j in range(1,n):
        xf[n-j]=x[n-1-j]
    xf[0]=bt%2
    return xf 

def stream(c,xp,n):  # key stream
    x=[0,0,0,0,0,0,0,0]
    for i in range(0,8):
        x[i]=xp[i]
    sr=''
    for i in range(0,n):
        sr+=str(x[0])
        x=shift(c,x)
    return sr

bin(ord('G')^^233)+bin(ord('I')^^148)
#'0b101011100b11011101'
#   101011100 11011101
#   101011100

M=[[1,1,0,1,0,0,1,0,1],
   [1,0,1,0,0,1,0,1,1],
   [0,1,0,0,1,0,1,1,1],
   [1,0,0,1,0,1,1,1,0],
   [0,0,1,0,1,1,1,0,0],
   [0,1,0,1,1,1,0,0,0],
   [1,0,1,1,1,0,0,0,0],
   [0,1,1,1,0,0,0,0,0]]

#trf(M, 0, [1,3,6])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 1, 1, 1, 0],
   [0, 1, 0, 0, 1, 0, 1, 1, 1],
   [0, 1, 0, 0, 0, 1, 0, 1, 1],
   [0, 0, 1, 0, 1, 1, 1, 0, 0],
   [0, 1, 0, 1, 1, 1, 0, 0, 0],
   [0, 1, 1, 0, 1, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 0, 0, 0, 0]]
#trf(M, 1, [2,3,5,6,7])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 1, 1, 1, 0],
   [0, 0, 1, 1, 1, 1, 0, 0, 1],
   [0, 0, 1, 1, 0, 0, 1, 0, 1],
   [0, 0, 1, 0, 1, 1, 1, 0, 0],
   [0, 0, 1, 0, 1, 0, 1, 1, 0],
   [0, 0, 0, 1, 1, 1, 0, 1, 1],
   [0, 0, 0, 0, 0, 1, 1, 1, 0]]
#trf(M, 2, [3,4,5])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 1, 1, 1, 0],
   [0, 0, 1, 1, 1, 1, 0, 0, 1],
   [0, 0, 0, 1, 0, 0, 1, 0, 1],      
   [0, 0, 0, 1, 0, 1, 1, 1, 1],
   [0, 0, 0, 1, 1, 1, 0, 1, 1],
   [0, 0, 0, 0, 1, 1, 1, 0, 0],
   [0, 0, 0, 0, 0, 1, 1, 1, 0]]
#trf(M, 3, [4,5])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 1, 1, 1, 0],
   [0, 0, 1, 1, 1, 1, 0, 0, 1],
   [0, 0, 0, 1, 0, 0, 1, 0, 1],
   [0, 0, 0, 0, 1, 1, 1, 1, 0],
   [0, 0, 0, 0, 1, 1, 1, 0, 0],
   [0, 0, 0, 0, 0, 1, 0, 1, 0],
   [0, 0, 0, 0, 0, 1, 1, 1, 0]]
#trf(M, 4, [5])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1],
   [0, 1, 1, 1, 0, 1, 1, 1, 0],
   [0, 0, 1, 1, 1, 1, 0, 0, 1],
   [0, 0, 0, 1, 0, 0, 1, 0, 1],
   [0, 0, 0, 0, 1, 1, 1, 1, 0],
   [0, 0, 0, 0, 0, 1, 0, 1, 0],
   [0, 0, 0, 0, 0, 1, 1, 1, 0],
   [0, 0, 0, 0, 0, 0, 0, 1, 0]]
#trf(M, 5, [6])
M=[[1, 1, 0, 1, 0, 0, 1, 0, 1], #c8+c7+c5+c2+1 = 1
   [0, 1, 1, 1, 0, 1, 1, 1, 0], #c7+c6+c5+c3+c2+c1 = 1 
   [0, 0, 1, 1, 1, 1, 0, 0, 1], #c6+c5+c4+c3+1 = 0
   [0, 0, 0, 1, 0, 0, 1, 0, 1], #c5+c2+1 = 1
   [0, 0, 0, 0, 1, 1, 1, 1, 0], #c4+c3+c2+c1 = 0
   [0, 0, 0, 0, 0, 1, 0, 1, 0], #c3+c1 = 0
   [0, 0, 0, 0, 0, 0, 1, 0, 0], #c2 = 0
   [0, 0, 0, 0, 0, 0, 0, 1, 0]] #c1 = 0
c1=0 
c2=0
c3=0
c4=0
c5=1
c6=0
c7=1
c8=1
c=[c1,c2,c3,c4,c5,c6,c7,c8]
# 10111011
c=[1,0,1,1,1,0,1,1]
#stream(c,c,16)
#k='0b101011100b11011101'
#01011100
#01010010
xp=[1,0,1,1,1,0,1,0]
#xp=xp[::-1]
k=stream(c, xp, 168)
#k='101101110101011101101110'
one=chr(int(k[0:8],2)^^148)+chr(int(k[8:16],2)^^17)+chr(int(k[16:24],2)^^238)+chr(int(k[24:32],2)^^242)+chr(int(k[32:40],2)^^59)+chr(int(k[40:48],2)^^51)+chr(int(k[48:56],2)^^190)
two=chr(int(k[56:64],2)^^162)+chr(int(k[64:72],2)^^159)+chr(int(k[72:80],2)^^146)+chr(int(k[80:88],2)^^233)+chr(int(k[88:96],2)^^226)+chr(int(k[96:104],2)^^1)
three=chr(int(k[104:112],2)^^33)+chr(int(k[112:120],2)^^229)+chr(int(k[120:128],2)^^156)+chr(int(k[128:136],2)^^20)+chr(int(k[136:144],2)^^247)+chr(int(k[144:152],2)^^242)
fore=chr(int(k[152:160],2)^^48)+chr(int(k[160:168],2)^^34)
one+two+three+fore
# 148, 17, 238, 242, 59, 51, 190
# 162, 159, 146, 233, 226, 1
# 33, 229, 156, 20, 247, 242
# 48, 34, 175, 163, 144, 139
#GILTINETOJIBUVOKAI
#bin(ord('G')^^238)+bin(ord('I')^^148)
#'0b101010010b11011101'
#'0b 101010010 b 11011101'