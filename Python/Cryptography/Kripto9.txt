'''


Nešifruotas tekstas
VISIZYNIOMOKINIAIJISTUREJOSAVOMOKYKLAVISURPASAKOJOAPIETAVEIDRODIKAIPAPIEKOKISTEBUKLATVIRTINDAMIKADTIKDABARATEJESMETASMATYTIZMOGUIRNETVISAPASAULITOKIKOKSISTIKRUJUYRA
I šifras 
[163, 216, 184, 106, 140, 30, 226, 198, 22, 83, 253, 118, 45, 52, 129, 180, 216, 161, 106, 133, 19, 249, 221, 28, 84, 253, 110, 37, 44, 135, 184, 222, 160, 122, 157, 11, 237, 217, 16, 77, 231, 111, 52, 59, 155, 180, 218, 164, 105, 153, 6, 252, 198, 28, 74, 243, 107, 33, 51, 140, 167, 222, 175, 106, 157, 6, 229, 223, 24, 78, 251, 120, 47, 53, 131, 188, 194, 191, 102, 148, 18, 231, 195, 24, 74, 228, 116, 54, 46, 129, 187, 213, 170, 110, 159, 12, 237, 203, 13, 87, 249, 121, 37, 56, 137, 167, 208, 191, 102, 156, 2, 255, 194, 28, 74, 243, 110, 41, 59, 156, 172, 197, 162, 121, 155, 8, 235, 218, 16, 76, 252, 120, 48, 44, 129, 166, 208, 187, 98, 133, 6, 249, 195, 16, 74, 253, 118, 45, 49, 135, 190, 194, 162, 112, 130, 14, 231, 221, 12, 84, 231, 100, 54, 59]
II šifras 
[166, 51, 140, 124, 203, 178, 109, 159, 8, 225, 192, 18, 87, 252, 116, 37, 51, 130, 188, 194, 191, 118, 132, 2, 230, 192, 10, 95, 228, 114, 41, 53, 131, 172, 218, 167, 98, 128, 14, 255, 218, 11, 78, 243, 110, 37, 49, 135, 191, 222, 170, 115, 159, 2, 248, 206, 15, 91, 251, 121, 54, 53, 140, 188, 218, 170, 106, 134, 6, 252, 198, 28, 85, 253, 118, 45, 41, 156, 176, 211, 190, 104, 154, 6, 248, 217, 16, 76, 230, 116, 42, 62, 137, 184, 216, 160, 98, 146, 19, 229, 196, 29, 95, 240, 124, 54, 59, 156, 176, 219, 174, 112, 155, 2, 248, 206, 10, 83, 243, 105, 61, 46, 129, 175, 220, 164, 100, 131, 14, 254, 193, 28, 74, 228, 116, 55, 59, 152, 180, 194, 170, 118, 154, 14, 248, 192, 18, 87, 249, 114, 47, 41, 129, 166, 197, 162, 104, 132, 18, 230, 218, 0, 76, 243]
Paverskite tekstą ir šifrus bitų srautais ir atlikite statistinius testus.
'''

# Chi-kvadrat su m laisvės laipsnių p- reikšmė
m=1
T = RealDistribution('chisquared', m)
t=2.5
p=1-T.cum_distribution_function(t)

# Standartinio normaliojo dėsnio p reikšmė
N= RealDistribution('gaussian', 1)
t=2.5
p=1-N.cum_distribution_function(t)
p

tek='VISIZYNIOMOKINIAIJISTUREJOSAVOMOKYKLAVISURPASAKOJOAPIETAVEIDRODIKAIPAPIEKOKISTEBUKLATVIRTINDAMIKADTIKDABARATEJESMETASMATYTIZMOGUIRNETVISAPASAULITOKIKOKSISTIKRUJUYRA'

sf1=[163, 216, 184, 106, 140, 30, 226, 198, 22, 83, 253, 118, 45, 52, 129, 180, 216, 161, 106, 133, 19, 249, 221, 28, 84, 253, 110, 37, 44, 135, 184, 222, 160, 122, 157, 11, 237, 217, 16, 77, 231, 111, 52, 59, 155, 180, 218, 164, 105, 153, 6, 252, 198, 28, 74, 243, 107, 33, 51, 140, 167, 222, 175, 106, 157, 6, 229, 223, 24, 78, 251, 120, 47, 53, 131, 188, 194, 191, 102, 148, 18, 231, 195, 24, 74, 228, 116, 54, 46, 129, 187, 213, 170, 110, 159, 12, 237, 203, 13, 87, 249, 121, 37, 56, 137, 167, 208, 191, 102, 156, 2, 255, 194, 28, 74, 243, 110, 41, 59, 156, 172, 197, 162, 121, 155, 8, 235, 218, 16, 76, 252, 120, 48, 44, 129, 166, 208, 187, 98, 133, 6, 249, 195, 16, 74, 253, 118, 45, 49, 135, 190, 194, 162, 112, 130, 14, 231, 221, 12, 84, 231, 100, 54, 59]
sf2=[166, 51, 140, 124, 203, 178, 109, 159, 8, 225, 192, 18, 87, 252, 116, 37, 51, 130, 188, 194, 191, 118, 132, 2, 230, 192, 10, 95, 228, 114, 41, 53, 131, 172, 218, 167, 98, 128, 14, 255, 218, 11, 78, 243, 110, 37, 49, 135, 191, 222, 170, 115, 159, 2, 248, 206, 15, 91, 251, 121, 54, 53, 140, 188, 218, 170, 106, 134, 6, 252, 198, 28, 85, 253, 118, 45, 41, 156, 176, 211, 190, 104, 154, 6, 248, 217, 16, 76, 230, 116, 42, 62, 137, 184, 216, 160, 98, 146, 19, 229, 196, 29, 95, 240, 124, 54, 59, 156, 176, 219, 174, 112, 155, 2, 248, 206, 10, 83, 243, 105, 61, 46, 129, 175, 220, 164, 100, 131, 14, 254, 193, 28, 74, 228, 116, 55, 59, 152, 180, 194, 170, 118, 154, 14, 248, 192, 18, 87, 249, 114, 47, 41, 129, 166, 197, 162, 104, 132, 18, 230, 218, 0, 76, 243]

b1=''
for r in tek:
    b1+=bin(ord(r))[2::]
#b1='10101101001001101001110010011011010101100110011101001001100111110011011001111100101110010011001110100100110000011001001100101010010011010011101010010101011010010100010110010101001111101001110000011010110100111110011011001111100101110110011001011100110010000011010110100100110100111010101101001010100001000001101001110000011001011100111110010101001111100000110100001001001100010110101001000001101011010001011001001100010010100101001111100010010010011001011100000110010011010000100000110100001001001100010110010111001111100101110010011010011101010010001011000010101010110010111001100100000110101001010110100100110100101010100100100110011101000100100000110011011001001100101110000011000100101010010010011001011100010010000011000010100000110100101000001101010010001011001010100010110100111001101100010110101001000001101001110011011000001101010010110011010100100100110110101001101100111110001111010101100100110100101001110100010110101001010110100100110100111000001101000010000011010011100000110101011001100100100110101001001111100101110010011001011100111110010111010011100100110100111010100100100110010111010010101010110010101010101101100110100101000001'    

b2=''
for r in sf1:
    b2+=bin(r)[2::]
#b2='10100011110110001011100011010101000110011110111000101100011010110101001111111101111011010110111010010000001101101001101100010100001110101010000101100111111100111011101111001010100111111011101110100101101100100001111011100011011110101000001111010100111011011111011011101100110000100110111100111110111111010011101110011011101101001101101010100100110100110011001110111111001100011011100100101011110011110101110000111001110001100101001111101111010101111110101010011101110111001011101111111000100111011111011111100010111111010110000011101111001100001010111111110011010010100100101110011111000011110001001010111001001110100110110101110100000011011101111010101101010101101110100111111100111011011100101111011010111111110011111001100101111000100010011010011111010000101111111100110100111001011111111110000101110010010101111001111011101010011110111001110010101100110001011010001011110011001101110001110101111011010100001001100111111001111000110000101100100000011010011011010000101110111100010100001011101111100111000011100001001010111111011110110101101110001100001111011111011000010101000101110000100000101110111001111101110111001010100111001111100100110110111011'

b3=''
for r in sf2:
    b3+=bin(r)[2::]
#b3='101001101100111000110011111001100101110110010110110110011111100011100001110000001001010101111111110011101001001011100111000001010111100110000101011111111101101000010010111001101100000010101011111111001001110010101001110101100000111010110011011010101001111100010100000001110111111111101101010111001110111100111101110100101110001100001111011111111011110101010101110011100111111011111000110011101111101101111111011111100111011011010110001100101111001101101010101010110101010000110110111111001100011011100101010111111101111011010110110100110011100101100001101001110111110110100010011010110111110001101100110000100110011100110111010010101011111010001001101110001101100010100000110001010010010100111110010111000100111011011111111100001111100110110111011100111001011000011011011101011101110000100110111011111000110011101010101001111110011110100111110110111010000001101011111101110010100100110010010000011111011111110110000011110010010101110010011101001101111110111001100010110100110000101010101011101101001101011101111100011000000100101010111111110011110010101111101001100000011010011011000101101000101101000100001001001011100110110110100100110011110011'

al=0.1
#Poker t:
m=3
N=[0,0,0,0,0,0,0,0]
k=len(b3)//m
for i in range(k):
    j=int(b3[m*i:(i+1)*m],2)
    N[j]+=1

T3=8.*sum([n*n for n in N])/k-k
l=7
T = RealDistribution('chisquared', 7)
p=1-T.cum_distribution_function(T3)
'''
Ats. Poker t:
    1) b1:
    T,p=28.6387434554974 0.00016835671021686593
    p < 0.1
    Seka ne atsitiktinė
    2) b2:
    T,p=37.8333333333333 3.2594382775030795e-06
    p < 0.1
    Seka ne atsitiktinė
    3) b3:
    T,p=24.0314136125655 0.0011249554596053368
    p < 0.1
    Seka ne atsitiktinė
'''
#print(T3, p)

# Autokoreliacijos t.
d=5
#b=b1 arba b2 arba b3
b=b3
b11=b[4::]
ilg=len(b11)
xd=0
for i in range (ilg):
    if b[i]!=b11[i]:
        xd+=1
        
T5=(2.*xd-len(b)+d)/sqrt(1.*len(b)-d)
N= RealDistribution('gaussian', 1)
p=1-N.cum_distribution_function(T5)
'''
Ats. Autokoreliacijos t.:
    1) b1:
    T, p=2.57333387730673, 0.005036199401170283
    p<0.05
    Seka ne atsitiktinė
    2) b2:
    T, p=-1.26855248744502, 0.8976996403578303
    p>0.05
    Seka atsitiktinė
    3) b3:
    T, p=-1.80587220157288, 0.9645308479206307
    p>0.05
    Seka atsitiktinė
'''
#print(T5, p)

# Frequency t.
count_0 = 0
count_1 = 0
#b=b1 arba b2 arba b3
b=b2
for bit in b:
    if bit == '0':
        count_0 += 1
    elif bit == '1':
        count_1 += 1

T1=(count_1 - count_0)^2/1.*len(b)

T=RealDistribution('chisquared', 1)
p=1-T.cum_distribution_function(T1)
'''
Ats. Daznio t.:
    1) b1:
        T, p = 5.62520000000000e6 0.0
        Seka ne atsitiktinė
    2) b2:
        T, p = 3.82250960000000e7 0.0
        Seka ne atsitiktinė
    3) b3:
        T, p = 2.78890560000000e7 0.0
        Seka ne atsitiktinė
'''
b=b3

N0 = b.count('0')
N1 = b.count('1')

N00 = N01 = N10 = N11 = 0

for i in range(len(b) - 1):
    pair = b[i:i+2]
    if pair == '00':
        N00 += 1
    elif pair == '01':
        N01 += 1
    elif pair == '10':
        N10 += 1
    elif pair == '11':
        N11 += 1
n=(1.*len(b))
T2 = (4 / (n-1)) * (N00^2 + N01^2 + N10^2 + N11^2) - (2 / n) * (N0^2 + N1^2) + 1
T=RealDistribution('chisquared', 2)
p=1-T.cum_distribution_function(T2)
nope='''
Ats. Bitu Poros:
    1) b1:
        T, p = 36.9967465498544 9.252488664124314e-09
        Seka ne atsitiktinė
    2) b2:
        T, p = 28.1940187680093 7.54651801604389e-07
        Seka ne atsitiktinė
    3) b3:
        T, p = 2.78890560000000e7 0.0
        Seka ne atsitiktinė
'''
#print(N00, N01, N10, N11)
#print(T2, p)
'''
At.: 
Daznio t.:
    1) Nešifruotas tekstas:
        T, p = 5.62520000000000e6 0.0
        Seka ne atsitiktinė
    2) I šifras:
        T, p = 3.82250960000000e7 0.0
        Seka ne atsitiktinė
    3) II šifras:
        T, p = 2.78890560000000e7 0.0
        Seka ne atsitiktinė

Bitu Poros:
    1) Nešifruotas tekstas:
        T, p = 36.9967465498544 9.252488664124314e-09
        Seka ne atsitiktinė
    2) I šifras:
        T, p = 28.1940187680093 7.54651801604389e-07
        Seka ne atsitiktinė
    3) II šifras:
        T, p = 20.7373236699514 3.140128209055959e-05
        Seka ne atsitiktinė 
        
Poker t:
    1) Nešifruotas tekstas:
        T,p=28.6387434554974 0.00016835671021686593
        Seka ne atsitiktinė
    2) I šifras:
        T,p=37.8333333333333 3.2594382775030795e-06
        Seka ne atsitiktinė
    3) II šifras:
        T,p=24.0314136125655 0.0011249554596053368
        Seka ne atsitiktinė
    
Autokoreliacijos t.:
    1) Nešifruotas tekstas:
        T, p=2.57333387730673, 0.005036199401170283
        Seka ne atsitiktinė
    2) I šifras:
        T, p=-1.26855248744502, 0.8976996403578303
        Seka atsitiktinė
    3) II šifras:
        T, p=-1.80587220157288, 0.9645308479206307
        Seka atsitiktinė
'''